{"mappings":"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","sources":["src/index.ts"],"sourcesContent":["interface MarqueeContentOptions {\n  element?: string | HTMLElement;\n}\n\nclass MarqueeContent {\n  private readonly gsap: never;\n\n  private readonly MM: never;\n\n  private timeline: never;\n\n  private readonly element: HTMLElement | null;\n\n  private resizeObserver: ResizeObserver;\n\n  private animationFrame: number | null = null;\n\n  static gsap: never;\n\n  static ScrollTrigger: never;\n\n  constructor({ element = '.marquee' }: MarqueeContentOptions = {}) {\n    this.gsap = MarqueeContent.gsap ?? (window as never).gsap;\n    this.MM = this.gsap.matchMedia();\n    this.timeline = null;\n    this.element = typeof element === 'string' ? document.querySelector(element) : element;\n\n    if (!this.element) return;\n\n    this.resizeObserver = new ResizeObserver(MarqueeContent.debounce(this.update));\n    this.resizeObserver.observe(this.element);\n  }\n\n  static registerGSAP(gsap: never, ScrollTrigger: never) {\n    MarqueeContent.gsap = gsap;\n    MarqueeContent.ScrollTrigger = ScrollTrigger;\n  }\n\n  private commonInit = () => {\n    if (this.element) {\n      this.clearTimeline();\n      this.cloneElements();\n      this.setBreakpoints();\n      this.applySkew();\n\n      this.timeline = this.createAnimation();\n    }\n  };\n\n  private update = () => {\n    if (this.animationFrame !== null) {\n      cancelAnimationFrame(this.animationFrame);\n    }\n\n    this.animationFrame = requestAnimationFrame(() => {\n      this.commonInit();\n\n      MarqueeContent.ScrollTrigger.refresh();\n    });\n  };\n\n  public init = () => {\n    this.commonInit();\n  };\n\n  public destroy = () => {\n    if (this.animationFrame !== null) {\n      cancelAnimationFrame(this.animationFrame);\n    }\n\n    if (this.element) {\n      this.clearTimeline();\n    }\n\n    this.resizeObserver?.disconnect();\n  };\n\n  private static debounce(func: (...args: never[]) => void) {\n    let timer: number | null = null;\n\n    return (...args: never[]) => {\n      if (timer !== null) {\n        cancelAnimationFrame(timer);\n      }\n\n      timer = requestAnimationFrame(() => func(...args));\n    };\n  }\n\n  private createAnimation() {\n    this.timeline?.kill();\n\n    const timeline = this.gsap.timeline({\n      scrollTrigger: {\n        trigger: this.element,\n        start: 'top bottom',\n        end: 'bottom top',\n        toggleActions: 'resume pause resume pause',\n        onUpdate: (self: never) => {\n          if (this.element?.dataset.mcDirection === 'ltr') {\n            timeline.timeScale(-1);\n          } else if (this.element?.dataset.mcDirection === 'auto') {\n            timeline.timeScale(self.direction);\n          }\n        },\n      },\n    });\n\n    this.MM.add(this.element?.dataset.mcBreakpoint, () => {\n      const duration = this.element?.dataset.mcDuration ? parseFloat(this.element?.dataset.mcDuration) : 20;\n\n      timeline.to(this.element?.children, {\n        duration,\n        x: '-100%',\n        repeat: -1,\n        ease: 'none',\n      });\n\n      timeline.totalProgress(0.5);\n\n      return () => timeline?.kill();\n    });\n\n    return timeline;\n  }\n\n  private setBreakpoints() {\n    if (this.element!.dataset.mcMax) {\n      this.element!.dataset.mcBreakpoint = `(max-width: ${parseFloat(this.element!.dataset.mcMax) - 0.02}px)`;\n    } else if (this.element!.dataset.mcMin) {\n      this.element!.dataset.mcBreakpoint = `(min-width: ${this.element!.dataset.mcMin}px)`;\n    } else {\n      this.element!.dataset.mcBreakpoint = '';\n    }\n  }\n\n  private clearTimeline() {\n    this.timeline?.kill();\n    this.timeline = null;\n    this.gsap.set(this.element!.children, { clearProps: 'all' });\n  }\n\n  private cloneElements() {\n    const removingClones = () => {\n      while (this.element!.childElementCount > 1) {\n        this.element!.removeChild(this.element!.lastChild as ChildNode);\n      }\n    };\n\n    removingClones();\n\n    this.MM.add(this.element!.dataset.mcBreakpoint, () => {\n      const requiredQuantity = Math.ceil(this.element!.scrollWidth / this.element!.firstElementChild!.clientWidth + 2);\n\n      if (this.element!.childElementCount < requiredQuantity) {\n        const fragment = document.createDocumentFragment();\n        const clones = Array.from({ length: requiredQuantity - 1 }, () => this.element!.firstElementChild!.cloneNode(true) as HTMLElement);\n\n        clones.forEach((clone) => fragment.appendChild(clone));\n\n        this.element!.appendChild(fragment);\n      }\n\n      return removingClones;\n    });\n  }\n\n  private applySkew() {\n    if (!this.element?.dataset.mcSkew) return;\n\n    const abs = Math.abs(parseInt(this.element.dataset.mcSkew, 10));\n    const { style } = this.element;\n\n    style.transformOrigin = 'center center';\n    style.transform = `skew(0deg, ${this.element.dataset.mcSkew}deg)`;\n    style.minHeight = `calc(${abs * 1.25}vh + ${abs * 1.25}vw)`;\n  }\n}\n\nexport default MarqueeContent;\n"],"names":[],"version":3,"file":"index.module.js.map"}